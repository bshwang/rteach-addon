p = bpy.context.scene.ik_motion_props
target_name = "Target_Gizmo"

# 1. 오브젝트 존재 확인
obj = bpy.data.objects.get(target_name)
print(f"[CHECK] Object '{target_name}' exists: {obj is not None}")

# 2. 컬렉션 연결 확인
if obj:
    collections = [c.name for c in obj.users_collection]
    print(f"[CHECK] '{target_name}' is in collections: {collections}")

# 3. poll 조건 수동 검증 (Setup 컬렉션 포함 여부)
in_setup = any(c.name == "Setup" and obj.name in c.objects for c in bpy.data.collections)
print(f"[CHECK] '{target_name}' is in Setup collection: {in_setup}")

# 4. goal_object 설정 테스트
if obj and in_setup:
    p.goal_object = obj
    print(f"[SET] goal_object set to: {p.goal_object.name}")
else:
    print("[FAIL] poll 조건을 만족하지 않아 goal_object로 등록 불가")
